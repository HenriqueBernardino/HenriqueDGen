---
title: "Home"
site: workflowr::wflow_site
output:
  workflowr::wflow_html:
    toc: false
editor_options:
  chunk_output_type: console
---

## Introduction

### Phenotypic data
Descriptive and deviance analysis were performed to verify the distribution and the genotypic effects for resistance to foliar diseases.
In this work we used a natural logarithm transformation for Affected area by Anthracnosis at the innoculated area at stem in cassava plants (AnAr).

```{r}
suppressMessages(library(tidyverse))
library(here)
suppressMessages(library(reactable))

# Data read by R using here package to allow the read in any computer with different directory path
PhenoData <- readRDS(here::here("data", "DadosFenotipicos.RDS"))
# Add the control information for the Mixed Models analysis
control <- names(table(PhenoData$accession_name)[table(PhenoData$accession_name) > 30])
PhenoData$control <- ifelse(PhenoData$accession_name %in% control, PhenoData$accession_name, "999") 
PhenoData$new <- ifelse(PhenoData$accession_name %in% control, 0, 1)

# Change the Disease names to english abbreviations
colnames(PhenoData)[7:11] <- c("Anth", "WhLS", "BrLS", "BlLS", "AnAr")

# Natural logarithm transformation for Anthracnosis Area
PhenoData$AnAr <- log(PhenoData$AnAr)
```

#### Table 1. Phenotypic data for resistance to foliar disease evaluated at the Cassava Germplasm Bank of EMBRAPA, data collected in 2021.
```{r, echo = FALSE}
PhenoData %>% reactable(defaultPageSize = 10)
```
Anthracnosis (Anth), White Leaf spot (WhLS), Brown Leaf spot (BrLS), Blight Leaf Spot (BlLS), Affected area by Anthracnosis at the innoculated area at stem in cassava plants (AnAr).

```{r, message = FALSE, warning = FALSE, eval = TRUE}
lnfUtl <- colnames(PhenoData)[c(1:4, 12:13)]
PhenoData$talhao_number <- NULL
PhenoData$Idade <- NULL
traits <- colnames(PhenoData)[!colnames(PhenoData) %in% lnfUtl]
PhenoData2 <- PhenoData %>% gather(key = traits, value = Y, -all_of(lnfUtl))
```

#### Table 2. Data entry for the descriptive analysis and mixed models for resistance of foliar disease in cassava.
```{r, echo = FALSE}
PhenoData2 %>% reactable(defaultPageSize = 10)
```
Anthracnosis (Anth), White Leaf spot (WhLS), Brown Leaf spot (BrLS), Blight Leaf Spot (BlLS), Affected area by Anthracnosis at the innoculated area at stem in cassava plants (AnAr).

```{r}
saveRDS(PhenoData2, here::here("output", "DadosFenotipicosv2.RDS"))
```


```{r}
# Rodar o script aqui dentro


#install.packages("reshape2")


library(reshape2)
DadosProdutivos <- read.table(here::here("data", "Dados Produtivos 2011-2021.CSV1.CSV"), header = T, sep = ";")

head(DadosProdutivos)


colnames(DadosProdutivos)[c(4,10:20)] <- c("Genotipo-BGM","AP", "APsF","DMC",
                                            "PTR","PRC", "PRNC","PPA","Vigor","Vigor45D","Vigor6M","Vigor12M")

DadosProdutivos2 <- DadosProdutivos[,1:16]







DadosProdutivosfin <- reshape2::melt(data = DadosProdutivos2,id.vars = c("Ano","Campo","Local","Genotipo-BGM","Genotipos","Bloco","Linha", "Coluna"),
                                     variable.name = "Trait",
                                     value.name = "Value") %>% filter(!is.na(Value))

saveRDS(object = DadosProdutivosfin, file = here::here("output", "DadosProdutivos.rds"))


DadosVigor <- DadosProdutivos[,c(1:8,17:20)]
head(DadosVigor)

DadosVigorFin <- reshape2::melt(data = DadosVigor, id.vars = c("Ano","Campo","Local","Genotipo-BGM",
                                    "Genotipos","Bloco","Linha","Coluna"),
                                         variable.name = "Epoca",
                                         value.name = "Value") %>% filter(!is.na(Value))

head(DadosVigorFin)

saveRDS(object = DadosVigorFin, file = here::here("output", "DadosVigor.rds"))
```


- [Descriptive Analysis](AnalisesDescritivas.html)

### [Mixed Models Analysis](AnalisesModelosMistos.html)

### [Discriminant Analysis of Principal Components](PCA_DAPC.html)

### [Dendrogram and Shannon-Weaver Index](Den_IndSH.html)
